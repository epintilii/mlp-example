import numpy as np
import pickle
import gzip
import mlp
import matplotlib.pyplot as plt

with gzip.open("mnist.pkl.gz", mode="rb") as f:
    train_set, valid_set, test_set = pickle.load(f, encoding="latin1")


examples = np.random.randint(40000, size = 10)


# for i in range(len(examples)):
#     image = np.reshape(train_set[0][examples[i], :], [28,28])
#     plt.imshow(image, cmap="gray")
#     plt.show()

train_x = valid_set[0]
train_y = valid_set[1]
print(train_y.shape)

# change y [1D] to Y [2D] sparse array coding class
n_examples = len(train_y)
labels = np.unique(train_y)

train_Y = np.zeros((n_examples, len(labels)))